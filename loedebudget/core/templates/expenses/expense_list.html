{% extends 'layout.html' %}

{% block title %}
    Expenses
{% endblock %}
{% block auth_title %}
    {{ user.username }}'s Expenses
{% endblock %}

{% block content %}
<h2>Sanity Check</h2>
{% if user.is_authenticated %}
    <div class="expenseTable">
        <table>
            <tr>
                <th>Site</th>
                <th>Username</th>
                <th>Password</th>
            </tr>
            {% for entry in expenses %} 
                <tr>
                    <td>{{ entry.name }}</td>
                    <td>{{ entry.amount }}</td>
                    <td>{{ entry.account }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="3">No expenses yet.</td>
                </tr>
            {% endfor %}
        </table>
    </div>
    <button id="toggleNewExpense" class="form-submit">New Expense</button>
    <form style="display: none;" method="post" action="{% url 'add_expense' %}" id="newExpense">
        {% csrf_token %}
        <label for="name">What was it:</label>
        <input type="text" name="name" required>
        <br>
        <label for="amount">Amount:</label>
        <input type="number" name="amount" step="0.01" required>
        <br>
        <label for="account">Account:</label>
        <input type="text" name="account" required>
        <br>
        <button type="submit">Submit</button>
        <input type="hidden" name="owner" value={{user.username}}>
    </form>
    <!--Script mostly generated by chatGPT -->
    <script> 
        document.getElementById("toggleNewExpense").addEventListener("click", function(){
            const form = document.getElementById("newExpense");
            form.style.display = form.style.display === "none" ? "block": "none";
        });
    </script>
    {% else %}
    <h2>Testing?</h2>
        <p>Please <a href="/users/login">sign in</a> or <a href="/users/register/">create an account</a></p>
    {% endif %}
{% endblock %} 